"use strict";(self.webpackChunkloan_system=self.webpackChunkloan_system||[]).push([[726],{562:()=>{},3726:(e,t,a)=>{a.r(t),a.d(t,{default:()=>m});var s=a(5043),n=a(3216),l=a(5150),r=(a(562),a(7488)),o=a(579);const c=[{id:"1",label:"\u0627\u0633\u062a\u0634\u0627\u0631\u064a"},{id:"2",label:"\u062a\u062c\u0647\u064a\u0632"},{id:"3",label:"\u0645\u0634\u0627\u0631\u064a\u0639"}],i=[{id:"1",Status:"\u0645\u0633\u062a\u0645\u0631"},{id:"2",Status:"\u0645\u0646\u062c\u0632"}],d=e=>{let{title:t,description:a}=e;(0,r.oR)((0,o.jsxs)("div",{children:[(0,o.jsx)("strong",{children:t}),(0,o.jsx)("div",{children:a})]}),{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})};function m(e){let{contractId:t,onClose:a}=e;const r=(0,n.Zp)(),m=t,h=Boolean(m),[u,x]=(0,s.useState)(!1),[p,b]=(0,s.useState)(!1),[j,N]=(0,s.useState)(""),[v,g]=(0,s.useState)(""),[y,f]=(0,s.useState)([]),[C,A]=(0,s.useState)(!1),[S,D]=(0,s.useState)(""),[P,w]=(0,s.useState)([]),[k,L]=(0,s.useState)([]),[I,O]=(0,s.useState)(!1),[$,T]=(0,s.useState)(""),[E,B]=(0,s.useState)(!1),[_,F]=(0,s.useState)(!1),[U,M]=(0,s.useState)([]),[G,z]=(0,s.useState)([]),[q,R]=(0,s.useState)(!1),[H,V]=(0,s.useState)(""),[Z,J]=(0,s.useState)({ContractNumber:"",ContractName:"",ContractType:"",CompanyName:"",Status:"",LoanId:"",ContractSigningDate:"",StartDate:"",CompleteDate:"",DurationInDays:"",AddedDays:"",ContractAmount:"",CostChange:"",CostPlanMins:"",CostAfterChange:"",CostToNatiBank:"",TotalCostPaid:"",Notes:"",OperationLoanCost:"",InsuranceDeposits:"",TaxTrusts:"",Penalties:"",OtherTrusts:""}),[K,Q]=(0,s.useState)({}),W=(e,t,a)=>{M((s=>{const n=[...s];return n[e]={...n[e],[t]:a},n}))},X=(e,t,a)=>{z((s=>{const n=[...s];return n[e]={...n[e],[t]:a},n}))},Y=U.reduce(((e,t)=>e+(parseFloat(t.Amount)||0)),0),ee=G.reduce(((e,t)=>e+(parseFloat(t.Amount)||0)),0),te=P.reduce(((e,t)=>e+(parseFloat(t.amount||t.Amount)||0)),0),ae=k.reduce(((e,t)=>e+(parseFloat(t.amount||t.Amount)||0)),0);(0,s.useEffect)((()=>{J((e=>({...e,CashPaid:Y.toString(),PrivateMoneyPaid:ee.toString()})))}),[Y,ee]);const se=async()=>{if(t){O(!0),T("");try{var e,a;const s=await l.A.get(`/Contracts/GetPaymentsByContractId/${t}`);console.log("Payments response:",s.data);let n=s.data;if(null!==(e=s.data)&&void 0!==e&&e.payments?n=s.data.payments:null!==(a=s.data)&&void 0!==a&&a.data?n=s.data.data:Array.isArray(s.data)&&(n=s.data),Array.isArray(n)){const e=n.map((e=>({id:e.id||e.ID||e.Id,amount:e.amount||e.Amount,paymentDate:e.paymentDate||e.PaymentDate,createdAt:e.createdAt||e.CreatedAt,updatedAt:e.updatedAt||e.UpdatedAt})));w(e)}else console.warn("Unexpected payments data format:",n),w([])}catch(s){console.error("Failed to load previous payments:",s),T("\u0641\u0634\u0644 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0633\u0627\u0628\u0642\u0629")}finally{O(!1)}}},ne=async()=>{if(t){R(!0),V("");try{var e,a;const s=await l.A.get(`/Contracts/GetPrivatePaymentsByContractId/${t}`);console.log("Private payments response:",s.data);let n=s.data;if(null!==(e=s.data)&&void 0!==e&&e.payments?n=s.data.payments:null!==(a=s.data)&&void 0!==a&&a.data?n=s.data.data:Array.isArray(s.data)&&(n=s.data),Array.isArray(n)){const e=n.map((e=>({id:e.id||e.ID||e.Id,amount:e.amount||e.Amount,paymentDate:e.paymentDate||e.PaymentDate,createdAt:e.createdAt||e.CreatedAt,updatedAt:e.updatedAt||e.UpdatedAt})));L(e)}else console.warn("Unexpected private payments data format:",n),L([])}catch(s){console.error("Failed to load previous private payments:",s),V("\u0641\u0634\u0644 \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629")}finally{R(!1)}}};(0,s.useEffect)((()=>{(async()=>{A(!0);try{var e;const t=await l.A.get("/Loan/GetAllLoans");f((null===(e=t.data)||void 0===e?void 0:e.loans)||[])}catch(t){D("\u0641\u0634\u0644 \u062a\u062d\u0645\u064a\u0644 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0642\u0631\u0648\u0636"),console.error("Error fetching loans:",t)}finally{A(!1)}})(),(async()=>{if(h){x(!0);try{var e,t;const a=await l.A.get(`/Contracts/GetContract/${m}`);let s;if(s=null!==(e=a.data)&&void 0!==e&&e.data?a.data.data:null!==(t=a.data)&&void 0!==t&&t.contract?a.data.contract:a.data,!s||0===Object.keys(s).length)throw new Error("No contract data was returned from the API");console.log("Contract data received:",s);const n={};Object.keys(Z).forEach((e=>{const t=Object.keys(s).find((t=>t.toLowerCase()===e.toLowerCase()));t&&(n[e]=s[t])})),["ContractSigningDate","StartDate","CompleteDate"].forEach((e=>{if(n[e]){const t=new Date(n[e]);isNaN(t)||(n[e]=t.toISOString().split("T")[0])}})),J((e=>({...e,...n})))}catch(n){var a,s;N((null===(a=n.response)||void 0===a||null===(s=a.data)||void 0===s?void 0:s.message)||n.message||"\u0641\u0634\u0644 \u062a\u062d\u0645\u064a\u0644 \u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0639\u0642\u062f."),console.error("Error fetching contract:",n)}finally{x(!1)}}})(),se(),ne()}),[m,h,t]);const le=e=>{const{name:t,value:a}=e.target;K[t]&&Q((e=>({...e,[t]:""}))),J((e=>({...e,[t]:a})))},re=function(e,t){var a;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(0,o.jsxs)("div",{className:"col-md-4 mb-3",children:[(0,o.jsxs)("label",{className:"form-label",children:[e," ",n&&(0,o.jsx)("span",{className:"text-danger",children:"*"})]}),(0,o.jsx)("input",{type:s,name:t,className:"form-control "+(K[t]?"is-invalid":""),value:null!==(a=Z[t])&&void 0!==a?a:"",onChange:le,required:n,...l}),K[t]&&(0,o.jsx)("div",{className:"invalid-feedback",children:K[t]})]})},oe=e=>{if(!e)return"Not specified";try{return new Date(e).toLocaleDateString("en-US")}catch{return"Not specified"}};return u?(0,o.jsx)("div",{className:"d-flex flex-column min-vh-100",children:(0,o.jsx)("main",{className:"flex-fill container my-4 text-center",children:(0,o.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."})})})}):(0,o.jsx)("div",{className:"d-flex flex-column min-vh-100 ",children:(0,o.jsx)("main",{className:"flex-fill container my-4",children:(0,o.jsxs)("div",{className:"card contract-form-container",children:[(0,o.jsx)("div",{className:"card-header d-flex justify-content-center align-items-center",children:(0,o.jsx)("h2",{className:"mb-0",children:h?"\u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0645\u0627\u0644\u064a\u0629 \u0644\u0644\u0639\u0642\u062f":"\u0625\u0636\u0627\u0641\u0629 \u0639\u0642\u062f \u062c\u062f\u064a\u062f"})}),(0,o.jsxs)("div",{className:"card-body",children:[j&&(0,o.jsx)("div",{className:"alert alert-danger",children:j}),v&&(0,o.jsx)("div",{className:"alert alert-success",children:v}),(0,o.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N(""),g(""),(()=>{const e={};Z.ContractNumber.trim()||(e.ContractNumber="\u0631\u0642\u0645 \u0627\u0644\u0639\u0642\u062f \u0645\u0637\u0644\u0648\u0628"),Z.ContractName.trim()||(e.ContractName="\u0627\u0633\u0645 \u0627\u0644\u0639\u0642\u062f \u0645\u0637\u0644\u0648\u0628"),console.log(e),U.forEach(((t,a)=>{t.Amount&&(isNaN(Number(t.Amount))||Number(t.Amount)<0)&&(e[`cashPayment_${a}`]="\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0645\u0628\u0644\u063a \u0631\u0642\u0645\u064a\u0629 \u0648\u063a\u064a\u0631 \u0633\u0627\u0644\u0628\u0629",console.log(e))})),G.forEach(((t,a)=>{t.Amount&&(isNaN(Number(t.Amount))||Number(t.Amount)<0)&&(e[`privatePayment_${a}`]="\u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0645\u0628\u0644\u063a \u0631\u0642\u0645\u064a\u0629 \u0648\u063a\u064a\u0631 \u0633\u0627\u0644\u0628\u0629",console.log(e))})),["ContractAmount","CostPlanMins","CostAfterChange","CostToNatiBank","TotalCostPaid","OperationLoanCost","DurationInDays","AddedDays","CostChange"].forEach((t=>{Z[t]&&(isNaN(Number(Z[t]))||Number(Z[t])<0)&&(e[t]="\u064a\u062c\u0628 \u0623\u0646 \u062a\u0643\u0648\u0646 \u0627\u0644\u0642\u064a\u0645\u0629 \u0631\u0642\u0645\u064a\u0629 \u0648\u063a\u064a\u0631 \u0633\u0627\u0644\u0628\u0629",console.log(e))})),Z.StartDate&&Z.CompleteDate&&new Date(Z.StartDate)>new Date(Z.CompleteDate)&&(e.CompleteDate="\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0625\u0646\u062c\u0627\u0632 \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0628\u0639\u062f \u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0645\u0628\u0627\u0634\u0631\u0629",console.log(e));return Q(e),0===Object.keys(e).length})()){b(!0);try{const{CashPaid:e,PrivateMoneyPaid:s,...n}=Z,o={...n,cashPaidPayments:U.filter((e=>e.Amount&&""!==e.Amount)).map((e=>({amount:Number(e.Amount),paymentDate:e.PaymentDate||null}))),privatePaidPayments:G.filter((e=>e.Amount&&""!==e.Amount)).map((e=>({amount:Number(e.Amount),paymentDate:e.PaymentDate||null})))};if(console.log("Submitting data:",o),h){await l.A.put(`/Contracts/UpdateContract/${m}`,o);const e=(e=>{if(!e||!y.length)return"";const t=y.find((t=>(t.id||t.ID)==e));return t?t.loanName||t.LoanName||t.name||t.Name:""})(Z.LoanId);d({title:"\u062a\u0645\u062a \u0627\u0644\u062a\u0639\u062f\u064a\u0644 \u0628\u0646\u062c\u0627\u062d",description:`${Z.ContractName} \u062a\u0645\u062a \u062a\u0639\u062f\u064a\u0644 \u0627\u0644\u0639\u0642\u062f \u0628\u0627\u0633\u0645 \u0627\u0644\u0634\u0631\u0643\u0629 ${Z.CompanyName}${e?` - \u0627\u0644\u0642\u0631\u0636: ${e}`:""}`}),g("\u062a\u0645 \u062a\u062d\u062f\u064a\u062b \u0627\u0644\u0639\u0642\u062f \u0628\u0646\u062c\u0627\u062d!"),await se(),await ne(),M([]),z([]),a(!0)}else{var t;const e=await l.A.post("/Contracts/AddContract",o);g("\u062a\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0639\u0642\u062f \u0628\u0646\u062c\u0627\u062d!"),null!==(t=e.data)&&void 0!==t&&t.id&&setTimeout((()=>r(`/EditContract/${e.data.id}`)),1500)}}catch(i){var s,n,o,c;console.error("Error saving contract:",i),console.error("Error response:",null===(s=i.response)||void 0===s?void 0:s.data),N(401===(null===(n=i.response)||void 0===n?void 0:n.status)?"\u063a\u064a\u0631 \u0645\u0635\u0631\u062d - \u0627\u0644\u0631\u062c\u0627\u0621 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062f\u062e\u0648\u0644.":(null===(o=i.response)||void 0===o||null===(c=o.data)||void 0===c?void 0:c.message)||"\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u062d\u0641\u0638 \u0627\u0644\u0639\u0642\u062f.")}finally{b(!1)}}else N("\u064a\u0631\u062c\u0649 \u062a\u0635\u062d\u064a\u062d \u0627\u0644\u0623\u062e\u0637\u0627\u0621 \u0641\u064a \u0627\u0644\u0646\u0645\u0648\u0630\u062c \u0642\u0628\u0644 \u0627\u0644\u0625\u0631\u0633\u0627\u0644.")},noValidate:!0,children:[(0,o.jsxs)("div",{className:"row",children:[re("\u0631\u0642\u0645 \u0627\u0644\u0639\u0642\u062f","ContractNumber","text",!0,{readOnly:!0}),re("\u0627\u0633\u0645 \u0627\u0644\u0639\u0642\u062f","ContractName","text",!0,{readOnly:!0}),(0,o.jsxs)("div",{className:"col-md-4 mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0646\u0648\u0639 \u0627\u0644\u0639\u0642\u062f"}),(0,o.jsxs)("select",{name:"ContractType",className:"form-select",value:Z.ContractType,onChange:le,disabled:!0,children:[(0,o.jsx)("option",{value:"",children:"-- \u0627\u062e\u062a\u0631 \u0646\u0648\u0639 \u0627\u0644\u0639\u0642\u062f --"}),c.map((e=>{let{id:t,label:a}=e;return(0,o.jsx)("option",{value:t,children:a},t)}))]})]}),re("\u0627\u0633\u0645 \u0627\u0644\u0634\u0631\u0643\u0629","CompanyName","text",!1,{readOnly:!0}),(0,o.jsxs)("div",{className:"col-md-4 mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0627\u0644\u062d\u0627\u0644\u0629"}),(0,o.jsxs)("select",{name:"Status",className:"form-select",value:Z.Status,onChange:le,disabled:!0,children:[(0,o.jsx)("option",{value:"",children:"-- \u0627\u062e\u062a\u0631 \u0627\u0644\u062d\u0627\u0644\u0629 --"}),i.map((e=>{let{id:t,Status:a}=e;return(0,o.jsx)("option",{value:t,children:a},t)}))]})]}),(0,o.jsxs)("div",{className:"col-md-4 mb-3",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0642\u0631\u0636"}),(0,o.jsxs)("select",{name:"LoanId",className:"form-select",value:Z.LoanId,onChange:le,disabled:!0,children:[(0,o.jsx)("option",{value:"",children:"-- \u0627\u062e\u062a\u0631 \u0627\u0644\u0642\u0631\u0636 --"}),y.map((e=>(0,o.jsx)("option",{value:e.id||e.ID,children:e.loanName||e.LoanName||e.name||e.Name},e.id||e.ID)))]}),S&&(0,o.jsx)("small",{className:"text-danger",children:S})]}),re("\u062a\u0627\u0631\u064a\u062e \u062a\u0648\u0642\u064a\u0639 \u0627\u0644\u0639\u0642\u062f","ContractSigningDate","date",!1,{readOnly:!0}),re("\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0645\u0628\u0627\u0634\u0631\u0629","StartDate","date",!1,{readOnly:!0}),re("\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0625\u0646\u062c\u0627\u0632","CompleteDate","date",!1,{readOnly:!0}),re("\u0645\u062f\u0629 \u0627\u0644\u0639\u0642\u062f \u0628\u0627\u0644\u0623\u064a\u0627\u0645","DurationInDays","number",!1,{readOnly:!0}),re("\u0627\u0644\u0623\u064a\u0627\u0645 \u0627\u0644\u0645\u0636\u0627\u0641\u0629","AddedDays","number",!1,{readOnly:!0}),re("\u0645\u0628\u0644\u063a \u0627\u0644\u0639\u0642\u062f","ContractAmount","number",!1,{readOnly:!0}),(0,o.jsx)("div",{className:"col-12",children:(0,o.jsx)("h4",{className:"text-primary border-bottom pb-2",children:"\u0628\u064a\u0627\u0646\u0627\u062a \u0627\u0644\u0627\u064a\u0631\u0627\u062f\u0627\u062a"})}),re("\u0627\u0648\u0627\u0645\u0631 \u0627\u0644\u063a\u064a\u0627\u0631","CostChange","number",!1,{readOnly:!0}),re("\u0643\u0644\u0641 \u0627\u0644\u0627\u062f\u0631\u0627\u062c \u0641\u064a \u0648\u0632\u0627\u0631\u0629 \u0627\u0644\u062a\u062e\u0637\u064a\u0637","CostPlanMins","number"),re("\u0643\u0644\u0641 \u0627\u0644\u0639\u0642\u062f \u0628\u0639\u062f \u0627\u0648\u0627\u0645\u0631 \u0627\u0644\u063a\u064a\u0627\u0631","CostAfterChange","number",!1,{readOnly:!0}),re("\u0627\u0644\u0645\u0628\u0627\u0644\u063a \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0629 \u0645\u0646 \u0642\u0628\u0644 \u0627\u0644\u0628\u0646\u0643 \u0627\u0644\u062f\u0648\u0644\u064a","CostToNatiBank","number"),re("\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u0627\u0644\u062a\u0631\u0627\u0643\u0645\u064a","TotalCostPaid","number"),re("\u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u0643\u0633\u0644\u0641\u0629 \u062a\u0634\u063a\u064a\u0644\u064a\u0629 10 %","OperationLoanCost","number"),(0,o.jsxs)("div",{className:"border-bottom d-flex justify-content-between",children:[(0,o.jsx)("h6",{className:"ChangeBg pb-2 "+(E?"text-danger":"text-info"),style:{cursor:"pointer"},onClick:()=>B((e=>!e)),children:E?"\u0625\u062e\u0641\u0627\u0621 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0646\u0642\u062f\u064a\u0629":"\u0627\u0644\u0627\u0637\u0644\u0627\u0639 \u0639\u0644\u0649 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0646\u0642\u062f\u064a\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629"}),(0,o.jsx)("h6",{className:"ChangeBg pb-2 "+(_?"text-danger":"text-info"),style:{cursor:"pointer"},onClick:()=>F((e=>!e)),children:_?"\u0625\u062e\u0641\u0627\u0621 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629":"\u0627\u0644\u0627\u0637\u0644\u0627\u0639 \u0639\u0644\u0649 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629"})]}),(0,o.jsxs)("div",{className:"col-12 mb-4",children:[E&&(0,o.jsxs)("h5",{className:"text-info border-bottom pb-2",children:["\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0645\u0627\u0644\u064a\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629 \u0643\u0627\u0634",P.length>0&&E&&(0,o.jsxs)("span",{className:"badge bg-info p-1 m-2",children:[P.length," \u062f\u0641\u0639\u0629"]})]}),I&&E&&(0,o.jsxs)("div",{className:"text-center p-3",children:[(0,o.jsx)("div",{className:"spinner-border spinner-border-sm text-primary",role:"status",children:(0,o.jsx)("span",{className:"visually-hidden",children:"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."})}),(0,o.jsx)("span",{className:"ms-2",children:"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0633\u0627\u0628\u0642\u0629..."})]}),$&&E&&(0,o.jsxs)("div",{className:"alert alert-warning",children:[(0,o.jsx)("i",{className:"bi bi-exclamation-triangle"})," ",$,(0,o.jsx)("button",{type:"button",className:"btn btn-sm btn-outline-primary ms-2",onClick:se,children:"\u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629"})]}),!I&&!$&&0===P.length&&E&&(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("i",{className:"bi bi-info-circle"})," \u0644\u0627 \u062a\u0648\u062c\u062f \u062f\u0641\u0639\u0627\u062a \u0646\u0642\u062f\u064a\u0629 \u0633\u0627\u0628\u0642\u0629 \u0645\u0633\u062c\u0644\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0639\u0642\u062f"]}),P.length>0&&E&&(0,o.jsx)("div",{className:"table-responsive",children:(0,o.jsxs)("table",{className:"table table-striped table-hover",children:[(0,o.jsx)("thead",{className:"table-light",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"#"}),(0,o.jsx)("th",{children:"\u0627\u0644\u0645\u0628\u0644\u063a"}),(0,o.jsx)("th",{children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062f\u0641\u0639"}),(0,o.jsx)("th",{children:"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"})]})}),(0,o.jsx)("tbody",{children:P.map(((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:t+1}),(0,o.jsx)("td",{children:(0,o.jsxs)("span",{className:"text-success fw-bold",children:[parseFloat(e.amount).toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]})}),(0,o.jsx)("td",{children:oe(e.paymentDate)}),(0,o.jsx)("td",{children:(0,o.jsxs)("button",{type:"button",className:"btn btn-outline-danger btn-sm p-0 w-50",onClick:()=>(async e=>{if(e&&window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u062f\u0641\u0639\u0629\u061f"))try{await l.A.delete(`/Contracts/DeletePayment/${e}`),w((t=>t.filter((t=>t.id!==e)))),d({title:"\u062a\u0645 \u0627\u0644\u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d",description:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629 \u0628\u0646\u062c\u0627\u062d"})}catch(s){var t,a;console.error("Error deleting payment:",s),d({title:"\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641",description:(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"\u0641\u0634\u0644 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629"})}})(e.id),title:"\u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629",children:[(0,o.jsx)("i",{className:"bi bi-trash"})," \u062d\u0630\u0641"]})})]},e.id||t)))}),(0,o.jsx)("tfoot",{className:"table-light",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{colSpan:"1",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639:"}),(0,o.jsxs)("th",{className:"text-success",children:[te.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),(0,o.jsx)("th",{colSpan:"3"})]})})]})})]}),(0,o.jsxs)("div",{className:"col-12 mb-3",children:[E&&(0,o.jsxs)("h5",{className:"text-secondary border-bottom pb-2",children:["\u0625\u0636\u0627\u0641\u0629 \u062f\u0641\u0639\u0627\u062a \u0646\u0642\u062f\u064a\u0629 \u062c\u062f\u064a\u062f\u0629",U.filter((e=>e.Amount)).length>0&&(0,o.jsxs)("span",{className:"badge bg-success ms-2",children:[U.filter((e=>e.Amount)).length," \u062f\u0641\u0639\u0629 \u062c\u062f\u064a\u062f\u0629"]})]}),U.map(((e,t)=>(0,o.jsx)("div",{className:"border p-3 mb-3 rounded",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0645\u0628\u0644\u063a"}),(0,o.jsx)("input",{type:"number",className:"form-control "+(K[`cashPayment_${t}`]?"is-invalid":""),value:e.Amount,onChange:e=>W(t,"Amount",e.target.value),min:"0",step:"0.01",placeholder:"\u0623\u062f\u062e\u0644 \u0627\u0644\u0645\u0628\u0644\u063a"}),K[`cashPayment_${t}`]&&(0,o.jsx)("div",{className:"invalid-feedback",children:K[`cashPayment_${t}`]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062f\u0641\u0639"}),(0,o.jsx)("input",{type:"date",className:"form-control",value:e.PaymentDate,onChange:e=>W(t,"PaymentDate",e.target.value)})]}),(0,o.jsxs)("div",{className:"col-md-4 d-flex align-items-end",children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>(e=>{U.length>=1&&M((t=>t.filter(((t,a)=>a!==e))))})(t),children:"\u062d\u0630\u0641"}),e.Amount&&(0,o.jsxs)("span",{className:"ms-2 badge bg-info",children:[parseFloat(e.Amount).toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]})]})]})},t))),E&&(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-success mb-3",onClick:()=>{M((e=>[...e,{Amount:"",PaymentDate:""}]))},children:"\u2795 \u0625\u0636\u0627\u0641\u0629 \u062f\u0641\u0639\u0629 \u0646\u0642\u062f\u064a\u0629"}),(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("strong",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062c\u062f\u064a\u062f\u0629: "}),(0,o.jsxs)("span",{className:"text-success fs-5",children:[Y.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),U.filter((e=>e.Amount)).length>0&&(0,o.jsxs)("small",{className:"d-block text-muted mt-2",children:["\u0639\u062f\u062f \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062c\u062f\u064a\u062f\u0629: ",U.filter((e=>e.Amount)).length]})]})]}),E&&(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("h6",{className:"alert-heading",children:"\u0645\u0644\u062e\u0635 \u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0646\u0642\u062f\u064a\u0629"}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0646\u0642\u062f\u064a\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629:"})," ",te.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0646\u0642\u062f\u064a\u0629 \u0627\u0644\u062c\u062f\u064a\u062f\u0629:"})," ",Y.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a:"}),(0,o.jsxs)("span",{className:"text-success fs-5 ms-1",children:[(te+Y).toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]})]})]})]})]}),(0,o.jsxs)("div",{className:"col-12 mb-4",children:[_&&(0,o.jsxs)("h5",{className:"text-info border-bottom pb-2",children:["\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u0645\u0627\u0644\u064a\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629 \u062e\u0627\u0635\u0629",k.length>0&&_&&(0,o.jsxs)("span",{className:"badge bg-info p-1 m-2",children:[k.length," \u062f\u0641\u0639\u0629"]})]}),0===k.length&&_&&(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("i",{className:"bi bi-info-circle"})," \u0644\u0627 \u062a\u0648\u062c\u062f \u062f\u0641\u0639\u0627\u062a \u062e\u0627\u0635\u0629 \u0633\u0627\u0628\u0642\u0629 \u0645\u0633\u062c\u0644\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0639\u0642\u062f"]}),k.length>0&&_&&(0,o.jsx)("div",{className:"table-responsive",children:(0,o.jsxs)("table",{className:"table table-striped table-hover",children:[(0,o.jsx)("thead",{className:"table-light",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"#"}),(0,o.jsx)("th",{children:"\u0627\u0644\u0645\u0628\u0644\u063a"}),(0,o.jsx)("th",{children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062f\u0641\u0639"}),(0,o.jsx)("th",{children:"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"})]})}),(0,o.jsx)("tbody",{children:k.map(((e,t)=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:t+1}),(0,o.jsx)("td",{children:(0,o.jsxs)("span",{className:"text-success fw-bold",children:[parseFloat(e.amount).toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]})}),(0,o.jsx)("td",{children:oe(e.paymentDate)}),(0,o.jsx)("td",{children:(0,o.jsxs)("button",{type:"button",className:"btn btn-outline-danger btn-sm p-0 w-50",onClick:()=>(async e=>{if(e&&window.confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u062f\u0641\u0639\u0629\u061f"))try{await l.A.delete(`/Contracts/DeletePrivatePayment/${e}`),L((t=>t.filter((t=>t.id!==e)))),d({title:"\u062a\u0645 \u0627\u0644\u062d\u0630\u0641 \u0628\u0646\u062c\u0627\u062d",description:"\u062a\u0645 \u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629 \u0628\u0646\u062c\u0627\u062d"})}catch(s){var t,a;console.error("Error deleting payment:",s),d({title:"\u062e\u0637\u0623 \u0641\u064a \u0627\u0644\u062d\u0630\u0641",description:(null===(t=s.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||"\u0641\u0634\u0644 \u0641\u064a \u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629"})}})(e.id),title:"\u062d\u0630\u0641 \u0627\u0644\u062f\u0641\u0639\u0629",children:[(0,o.jsx)("i",{className:"bi bi-trash"})," \u062d\u0630\u0641"]})})]},e.id||t)))}),(0,o.jsx)("tfoot",{className:"table-light",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{colSpan:"1",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639:"}),(0,o.jsxs)("th",{className:"text-success",children:[ae.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),(0,o.jsx)("th",{colSpan:"3"})]})})]})})]}),(0,o.jsxs)("div",{className:"col-12 mb-3",children:[_&&(0,o.jsxs)("h5",{className:"text-secondary border-bottom pb-2",children:["\u0625\u0636\u0627\u0641\u0629 \u062f\u0641\u0639\u0627\u062a \u062e\u0627\u0635\u0629 \u062c\u062f\u064a\u062f\u0629",G.filter((e=>e.Amount)).length>0&&(0,o.jsxs)("span",{className:"badge bg-success ms-2",children:[G.filter((e=>e.Amount)).length," \u062f\u0641\u0639\u0629 \u062c\u062f\u064a\u062f\u0629"]})]}),G.map(((e,t)=>(0,o.jsx)("div",{className:"border p-3 mb-3 rounded",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0645\u0628\u0644\u063a"}),(0,o.jsx)("input",{type:"number",className:"form-control "+(K[`privatePayment_${t}`]?"is-invalid":""),value:e.Amount,onChange:e=>X(t,"Amount",e.target.value),min:"0",step:"0.01",placeholder:"\u0623\u062f\u062e\u0644 \u0627\u0644\u0645\u0628\u0644\u063a"}),K[`privatePayment_${t}`]&&(0,o.jsx)("div",{className:"invalid-feedback",children:K[`privatePayment_${t}`]})]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("label",{className:"form-label",children:"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062f\u0641\u0639"}),(0,o.jsx)("input",{type:"date",className:"form-control",value:e.PaymentDate,onChange:e=>X(t,"PaymentDate",e.target.value)})]}),(0,o.jsxs)("div",{className:"col-md-4 d-flex align-items-end",children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>(e=>{G.length>=1&&z((t=>t.filter(((t,a)=>a!==e))))})(t),children:"\u062d\u0630\u0641"}),e.Amount&&(0,o.jsxs)("span",{className:"ms-2 badge bg-info",children:[parseFloat(e.Amount).toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]})]})]})},t))),_&&(0,o.jsxs)("div",{children:[(0,o.jsx)("button",{type:"button",className:"btn btn-outline-success mb-3",onClick:()=>{z((e=>[...e,{Amount:"",PaymentDate:""}]))},children:"\u2795 \u0627\u0636\u0627\u0641\u0629 \u062f\u0641\u0639\u0629 \u062e\u0627\u0635\u0629"}),(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("strong",{children:"\u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062c\u062f\u064a\u062f\u0629: "}),(0,o.jsxs)("span",{className:"text-success fs-5",children:[ee.toLocaleString()," \u062f\u064a\u0646\u0627\u0631"]}),G.filter((e=>e.Amount)).length>0&&(0,o.jsxs)("small",{className:"d-block text-muted",children:["\u0639\u062f\u062f \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062c\u062f\u064a\u062f\u0629: ",G.filter((e=>e.Amount)).length]})]})]}),_&&(0,o.jsxs)("div",{className:"alert alert-info",children:[(0,o.jsx)("h6",{className:"alert-heading",children:"\u0645\u0644\u062e\u0635 \u0625\u062c\u0645\u0627\u0644\u064a \u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629"}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0627\u0644\u0633\u0627\u0628\u0642\u0629:"})," ",ae.toLocaleString()," \u062f\u064a\u0646\u0627\u0631 "]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u062f\u0641\u0639\u0627\u062a \u0627\u0644\u062e\u0627\u0635\u0629 \u0627\u0644\u062c\u062f\u064a\u062f\u0629:"})," ",ee.toLocaleString()," \u062f\u064a\u0646\u0627\u0631 "]}),(0,o.jsxs)("div",{className:"col-md-4",children:[(0,o.jsx)("strong",{children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a:"}),(0,o.jsxs)("span",{className:"text-success fs-5 ms-1",children:[(ae+ee).toLocaleString()," \u062f\u064a\u0646\u0627\u0631 "]})]})]})]})]}),re("\u062a\u0623\u0645\u064a\u0646\u0627\u062a","InsuranceDeposits","number"),re("\u0623\u0645\u0627\u0646\u0627\u062a \u0636\u0631\u064a\u0628\u064a\u0629","TaxTrusts","number"),re("\u063a\u0631\u0627\u0645\u0627\u062a","Penalties","number"),re("\u0623\u0645\u0627\u0646\u0627\u062a \u0623\u062e\u0631\u0649","OtherTrusts","number"),(0,o.jsxs)("div",{className:"col-12",children:[(0,o.jsx)("label",{className:"form-label",children:"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"}),(0,o.jsx)("textarea",{name:"Notes",className:"form-control",rows:"3",value:Z.Notes,onChange:le})]})]}),(0,o.jsxs)("div",{className:"d-flex justify-content-between mt-4 gap-5",children:[(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"\u062c\u0627\u0631\u064a \u0627\u0644\u062d\u0641\u0638...":"\u062d\u0641\u0638"}),(0,o.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>a(),disabled:p,children:"\u0625\u0644\u063a\u0627\u0621"})]})]})]})]})})})}},5150:(e,t,a)=>{a.d(t,{A:()=>c});var s=a(6213);const n=s.A.create({baseURL:"http://localhost:5109",withCredentials:!0});let l=!1,r=[];const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r.forEach((a=>{e?a.reject(e):a.resolve(t)})),r=[]};n.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e})),n.interceptors.response.use((e=>e),(async e=>{const t=e.config;if(t&&!t._retry&&("Access token expired"===e.message||e.response&&401===e.response.status)){if(l)return new Promise(((e,t)=>{r.push({resolve:e,reject:t})})).then((e=>(t.headers.Authorization=`Bearer ${e}`,n(t)))).catch((e=>Promise.reject(e)));t._retry=!0,l=!0;try{const e=await s.A.post("http://localhost:5109/auth/refresh",{},{withCredentials:!0}),a=e.data.accessToken;e.data.refreshToken;return localStorage.setItem("token",a),o(null,a),t.headers.Authorization=`Bearer ${a}`,n(t)}catch(a){return o(a,null),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/",Promise.reject(a)}finally{l=!1}}return Promise.reject(e)}));const c=n}}]);
//# sourceMappingURL=726.bb8cafb4.chunk.js.map