{"version":3,"file":"static/js/488.f649c362.chunk.js","mappings":"sMAOA,MAmIMA,EAAwBC,IAAmB,IAAlB,SAAEC,GAAUD,EACzC,MACME,EAAiB,CAAC,SAAU,SAAU,UAAW,OAAQ,UAAW,WAE1E,OACEC,EAAAA,EAAAA,MAAA,OAAKC,UAAU,yBAAwBC,SAAA,EACrCC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,WAAWG,MAAO,CAAEC,OAAQ,OAAQH,UACjDC,EAAAA,EAAAA,KAAA,OACEF,UAAW,mBAAmBF,EAAeD,KAC7CM,MAAO,CAAEE,MAAWR,EAAW,EAAK,IAApB,UAGpBK,EAAAA,EAAAA,KAAA,SAAOF,UAAW,QAAQF,EAAeD,KAAYI,SAXlC,CAAC,YAAa,OAAQ,OAAQ,OAAQ,SAAU,eAYjDJ,OAEd,EAIV,EAtJ2BS,KACzB,MAAM,SAAEC,EAAQ,aAAEC,EAAY,MAAEC,EAAOC,WAAW,OAAEC,GAAQ,MAAEC,IAAUC,EAAAA,EAAAA,OACjEC,EAAWC,IAAgBC,EAAAA,EAAAA,WAAS,IACpCC,EAAsBC,IAA2BF,EAAAA,EAAAA,UAAS,OAC1DG,EAAkBC,IAAuBJ,EAAAA,EAAAA,UAAS,GACrDK,GAAWC,EAAAA,EAAAA,MAuDf,OACEvB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,uBAAsBC,SAAA,EACnCC,EAAAA,EAAAA,KAAA,MAAAD,SAAI,sFACJF,EAAAA,EAAAA,MAAA,QAAMwB,SAAUf,GA/BHgB,UACf,GAAKP,EAAL,CAKAF,GAAa,GACb,IACE,MAAMU,QAAiBC,EAAAA,EAAIC,KAAK,wBAAyBC,GAErDH,EAASG,KAAKC,SAChBC,EAAAA,GAAMD,QAAQJ,EAASG,KAAKG,SAC5BnB,IACAM,EAAwB,MACxBE,EAAoB,IAEpBU,EAAAA,GAAME,MAAMP,EAASG,KAAKG,QAE9B,CAAE,MAAOC,GAAQ,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EACd,MAAMC,GAAyB,QAAdL,EAAAD,EAAMP,gBAAQ,IAAAQ,GAAM,QAANC,EAAdD,EAAgBL,YAAI,IAAAM,OAAN,EAAdA,EAAsBH,WACT,QADgBI,EAC9BH,EAAMP,gBAAQ,IAAAU,GAAM,QAANC,EAAdD,EAAgBP,YAAI,IAAAQ,GAAQ,QAARC,EAApBD,EAAsBzB,cAAM,IAAA0B,OAAd,EAAdA,EAA8BE,KAAK,QACnC,yBAChBT,EAAAA,GAAME,MAAMM,EACd,CAAC,QACCvB,GAAa,EACf,CArBA,MAFEe,EAAAA,GAAME,MAAM,8CAuBd,IAMyC/B,SAAA,EACrCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,kGACPC,EAAAA,EAAAA,KAAA,SACEsC,KAAK,WACLxC,UAAW,gBAAgBW,EAAO8B,kBAA4C,IAAzBxB,EAAiC,aAAe,MAAMA,EAAuB,WAAa,QAC3IV,EAAS,kBAAmB,CAC9BmC,SAAU,oIACVC,OAhEoBnB,UAC9B,MAAMiB,EAAkBhC,EAAM,mBAC9B,GAAKgC,EAEL,IACE,MAAMhB,QAAiBC,EAAAA,EAAIC,KAAK,kCAAmC,CACjEiB,SAAUH,IAEZvB,EAAwBO,EAASG,KAAKiB,QACxC,CAAE,MAAOb,GACPF,EAAAA,GAAME,MAAM,sCACd,OAwDOrB,EAAO8B,kBACNvC,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,SAAEU,EAAO8B,gBAAgBV,WAElC,IAAzBd,IACCf,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,SAAC,sCAItCF,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,kGACPC,EAAAA,EAAAA,KAAA,SACEsC,KAAK,WACLxC,UAAW,iBAAgBW,EAAOmC,YAAc,aAAe,OAC3DvC,EAAS,eACbwC,SAAWC,GAAM5B,EAnEQwB,KACjC,IAAI/C,EAAW,EAOf,OANI+C,EAASK,QAAU,GAAGpD,IACtB+C,EAASK,QAAU,IAAIpD,IACvB,QAAQqD,KAAKN,IAAW/C,IACxB,QAAQqD,KAAKN,IAAW/C,IACxB,QAAQqD,KAAKN,IAAW/C,IACxB,eAAeqD,KAAKN,IAAW/C,IAC5BsD,KAAKC,IAAIvD,EAAU,EAAE,EA2DiBwD,CAA0BL,EAAEM,OAAOC,UAEzE5C,EAAOmC,cACN5C,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,SAAEU,EAAOmC,YAAYf,WAExD7B,EAAAA,EAAAA,KAACP,EAAqB,CAACE,SAAUsB,QAGnCpB,EAAAA,EAAAA,MAAA,OAAKC,UAAU,aAAYC,SAAA,EACzBC,EAAAA,EAAAA,KAAA,SAAAD,SAAO,iIACPC,EAAAA,EAAAA,KAAA,SACEsC,KAAK,WACLxC,UAAW,iBAAgBW,EAAO6C,gBAAkB,aAAe,OAC/DjD,EAAS,qBAEdI,EAAO6C,kBACNtD,EAAAA,EAAAA,KAAA,OAAKF,UAAU,mBAAkBC,SAAEU,EAAO6C,gBAAgBzB,cAI9D7B,EAAAA,EAAAA,KAAA,UACEsC,KAAK,SACLxC,UAAU,kBACVyD,SAAU3C,EAAUb,SAEnBa,EAAY,mEAAmB,sFAG1BZ,EAAAA,EAAAA,KAAA,UACEsC,KAAK,SACLxC,UAAU,wCACV0D,QAASA,KAEPrC,EAAS,IAAI,EACbpB,SACH,8EAIP,C,gDCpIV,MAAMyB,EAAMiC,EAAAA,EAAMC,OAAO,CACvBC,QAAS,uBACTC,iBAAiB,IAGnB,IAAIC,GAAe,EACfC,EAAc,GAElB,MAAMC,EAAe,SAACjC,GAAyB,IAAlBkC,EAAKC,UAAAlB,OAAA,QAAAmB,IAAAD,UAAA,GAAAA,UAAA,GAAG,KACnCH,EAAYK,SAAQC,IACdtC,EACFsC,EAAQC,OAAOvC,GAEfsC,EAAQE,QAAQN,EAClB,IAEFF,EAAc,EAChB,EAEAtC,EAAI+C,aAAaC,QAAQC,KAAIC,IAC3B,MAAMV,EAAQW,aAAaC,QAAQ,SAInC,OAHIZ,IACFU,EAAOG,QAAQC,cAAgB,UAAUd,KAEpCU,CAAM,IAGflD,EAAI+C,aAAahD,SAASkD,KACxBlD,GAAYA,IACZD,UACE,MAAMyD,EAAkBjD,EAAM4C,OAE9B,GACEK,IACCA,EAAgBC,SACE,yBAAlBlD,EAAMD,SAAuCC,EAAMP,UAAsC,MAA1BO,EAAMP,SAAS0D,QAC/E,CACA,GAAIpB,EACF,OAAO,IAAIqB,SAAQ,CAACZ,EAASD,KAC3BP,EAAYqB,KAAK,CAAEb,UAASD,UAAS,IAEpCe,MAAKpB,IACJe,EAAgBF,QAAQC,cAAgB,UAAUd,IAC3CxC,EAAIuD,MAEZM,OAAMC,GAAOJ,QAAQb,OAAOiB,KAGjCP,EAAgBC,QAAS,EACzBnB,GAAe,EAEf,IACE,MAAMtC,QAAiBkC,EAAAA,EAAMhC,KAAK,oCAAqC,CAAC,EAAE,CAACmC,iBAAkB,IACvF2B,EAAiBhE,EAASG,KAAK8D,YACbjE,EAASG,KAAK+D,aAOtC,OALAd,aAAae,QAAQ,QAASH,GAE9BxB,EAAa,KAAMwB,GAEnBR,EAAgBF,QAAQC,cAAgB,UAAUS,IAC3C/D,EAAIuD,EACb,CAAE,MAAOO,GAKP,OAJAvB,EAAauB,EAAK,MAClBX,aAAagB,WAAW,SACxBhB,aAAagB,WAAW,gBACxBC,OAAOC,SAASC,KAAO,IAChBZ,QAAQb,OAAOiB,EACxB,CAAC,QACCzB,GAAe,CACjB,CACF,CAEA,OAAOqB,QAAQb,OAAOvC,EAAM,IAIhC,S","sources":["Component/PasswordChangeForm.js","Api/AxiosClient.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useForm } from 'react-hook-form';\nimport api from '../Api/AxiosClient'\nimport { toast } from 'react-toastify';\nimport '../Style/PasswordChangeForm.css';\nimport { useNavigate } from 'react-router-dom';\n\nconst PasswordChangeForm = () => {\n  const { register, handleSubmit, watch, formState: { errors }, reset } = useForm();\n  const [isLoading, setIsLoading] = useState(false);\n  const [currentPasswordValid, setCurrentPasswordValid] = useState(null);\n  const [passwordStrength, setPasswordStrength] = useState(0);\nconst navigate = useNavigate();\n\n  const validateCurrentPassword = async () => {\n    const currentPassword = watch('currentPassword');\n    if (!currentPassword) return;\n    \n    try {\n      const response = await api.post('/Auth/validate-current-password', {\n        password: currentPassword\n      });\n      setCurrentPasswordValid(response.data.isValid);\n    } catch (error) {\n      toast.error(\"Failed to validate current password\");\n    }\n  };\n\n  const calculatePasswordStrength = (password) => {\n    let strength = 0;\n    if (password.length >= 8) strength++;\n    if (password.length >= 12) strength++;\n    if (/[A-Z]/.test(password)) strength++;\n    if (/[a-z]/.test(password)) strength++;\n    if (/[0-9]/.test(password)) strength++;\n    if (/[^A-Za-z0-9]/.test(password)) strength++;\n    return Math.min(strength, 5);\n  };\n\n  const onSubmit = async (data) => {\n    if (!currentPasswordValid) {\n      toast.error(\"Please validate your current password first\");\n      return;\n    }\n\n    setIsLoading(true);\n    try {\n      const response = await api.post('/Auth/change-password', data);\n      \n      if (response.data.success) {\n        toast.success(response.data.message);\n        reset();\n        setCurrentPasswordValid(null);\n        setPasswordStrength(0);\n      } else {\n        toast.error(response.data.message);\n      }\n    } catch (error) {\n      const errorMsg = error.response?.data?.message || \n                      error.response?.data?.errors?.join('\\n') || \n                      \"Password change failed\";\n      toast.error(errorMsg);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"password-change-form\">\n      <h2>تغيير كلمة السر</h2>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <div className=\"form-group\">\n          <label>كلمة السر الحالية</label>\n          <input\n            type=\"password\"\n            className={`form-control ${errors.currentPassword || currentPasswordValid === false ? 'is-invalid' : ''} ${currentPasswordValid ? 'is-valid' : ''}`}\n            {...register('currentPassword', { \n              required: 'كلمة السر الحالية مطلوبة',\n              onBlur: validateCurrentPassword\n            })}\n          />\n          {errors.currentPassword && (\n            <div className=\"invalid-feedback\">{errors.currentPassword.message}</div>\n          )}\n          {currentPasswordValid === false && (\n            <div className=\"invalid-feedback\">Current password is incorrect</div>\n          )}\n        </div>\n\n        <div className=\"form-group\">\n          <label>كلمة السر الجديدة</label>\n          <input\n            type=\"password\"\n            className={`form-control ${errors.newPassword ? 'is-invalid' : ''}`}\n            {...register('newPassword')}\n            onChange={(e) => setPasswordStrength(calculatePasswordStrength(e.target.value))}\n          />\n          {errors.newPassword && (\n            <div className=\"invalid-feedback\">{errors.newPassword.message}</div>\n          )}\n          <PasswordStrengthMeter strength={passwordStrength} />\n        </div>\n\n        <div className=\"form-group\">\n          <label>تأكيد كلمة السر الجديدة</label>\n          <input\n            type=\"password\"\n            className={`form-control ${errors.confirmPassword ? 'is-invalid' : ''}`}\n            {...register('confirmPassword')}\n          />\n          {errors.confirmPassword && (\n            <div className=\"invalid-feedback\">{errors.confirmPassword.message}</div>\n          )}\n        </div>\n\n        <button \n          type=\"submit\" \n          className=\"btn btn-primary\"\n          disabled={isLoading}\n        >\n          {isLoading ? 'يتم التغيير...' : 'تغيير كلمة السر'}\n        </button>\n        \n                <button \n                  type=\"button\" \n                  className=\"btn btn-default form-control p-1 mt-1\"\n                  onClick={() => {\n\n                    navigate('/');\n                  }}\n                >\n                  إلغاء/ العودة\n                </button>\n      </form>\n    </div>\n  );\n};\n\nconst PasswordStrengthMeter = ({ strength }) => {\n  const strengthLabels = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong', 'Very Strong'];\n  const strengthColors = ['danger', 'danger', 'warning', 'info', 'success', 'success'];\n  \n  return (\n    <div className=\"password-strength mt-2\">\n      <div className=\"progress\" style={{ height: '5px' }}>\n        <div \n          className={`progress-bar bg-${strengthColors[strength]}`}\n          style={{ width: `${(strength / 5) * 100}%` }}\n        ></div>\n      </div>\n      <small className={`text-${strengthColors[strength]}`}>\n        {strengthLabels[strength]}\n      </small>\n    </div>\n  );\n};\n\nexport default PasswordChangeForm;","import axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'http://192.168.0.106',\n  withCredentials: true\n});\n\nlet isRefreshing = false;\nlet failedQueue = [];\n\nconst processQueue = (error, token = null) => {\n  failedQueue.forEach(promise => {\n    if (error) {\n      promise.reject(error);\n    } else {\n      promise.resolve(token);\n    }\n  });\n  failedQueue = [];\n};\n\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n});\n\napi.interceptors.response.use(\n  response => response,\n  async error => {\n    const originalRequest = error.config;\n\n    if (\n      originalRequest &&\n      !originalRequest._retry &&\n      (error.message === \"Access token expired\" || (error.response && error.response.status === 401))\n    ) {\n      if (isRefreshing) {\n        return new Promise((resolve, reject) => {\n          failedQueue.push({ resolve, reject });\n        })\n          .then(token => {\n            originalRequest.headers.Authorization = `Bearer ${token}`;\n            return api(originalRequest);\n          })\n          .catch(err => Promise.reject(err));\n      }\n\n      originalRequest._retry = true;\n      isRefreshing = true;\n\n      try {\n        const response = await axios.post('http://192.168.0.106/auth/refresh', {},{withCredentials : true});\n        const newAccessToken = response.data.accessToken;\n        const newRefreshToken = response.data.refreshToken;\n\n        localStorage.setItem('token', newAccessToken);\n\n        processQueue(null, newAccessToken);\n\n        originalRequest.headers.Authorization = `Bearer ${newAccessToken}`;\n        return api(originalRequest);\n      } catch (err) {\n        processQueue(err, null);\n        localStorage.removeItem(\"token\");\n        localStorage.removeItem(\"refreshToken\");\n        window.location.href = \"/\";\n        return Promise.reject(err);\n      } finally {\n        isRefreshing = false;\n      }\n    }\n\n    return Promise.reject(error);\n  }\n);\n\nexport default api;\n"],"names":["PasswordStrengthMeter","_ref","strength","strengthColors","_jsxs","className","children","_jsx","style","height","width","PasswordChangeForm","register","handleSubmit","watch","formState","errors","reset","useForm","isLoading","setIsLoading","useState","currentPasswordValid","setCurrentPasswordValid","passwordStrength","setPasswordStrength","navigate","useNavigate","onSubmit","async","response","api","post","data","success","toast","message","error","_error$response","_error$response$data","_error$response2","_error$response2$data","_error$response2$data2","errorMsg","join","type","currentPassword","required","onBlur","password","isValid","newPassword","onChange","e","length","test","Math","min","calculatePasswordStrength","target","value","confirmPassword","disabled","onClick","axios","create","baseURL","withCredentials","isRefreshing","failedQueue","processQueue","token","arguments","undefined","forEach","promise","reject","resolve","interceptors","request","use","config","localStorage","getItem","headers","Authorization","originalRequest","_retry","status","Promise","push","then","catch","err","newAccessToken","accessToken","refreshToken","setItem","removeItem","window","location","href"],"sourceRoot":""}