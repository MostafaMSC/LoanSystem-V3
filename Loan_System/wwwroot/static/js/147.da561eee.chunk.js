"use strict";(self.webpackChunkloan_system=self.webpackChunkloan_system||[]).push([[147],{5150:(e,t,a)=>{a.d(t,{A:()=>d});var n=a(6213);const s=n.A.create({baseURL:"http://172.16.2.101:5109",withCredentials:!0});let r=!1,l=[];const o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;l.forEach((a=>{e?a.reject(e):a.resolve(t)})),l=[]};s.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e})),s.interceptors.response.use((e=>e),(async e=>{const t=e.config;if(t&&!t._retry&&("Access token expired"===e.message||e.response&&401===e.response.status)){if(r)return new Promise(((e,t)=>{l.push({resolve:e,reject:t})})).then((e=>(t.headers.Authorization=`Bearer ${e}`,s(t)))).catch((e=>Promise.reject(e)));t._retry=!0,r=!0;try{const e=await n.A.post("http://172.16.2.101:5109/auth/refresh",{},{withCredentials:!0}),a=e.data.accessToken;e.data.refreshToken;return localStorage.setItem("token",a),o(null,a),t.headers.Authorization=`Bearer ${a}`,s(t)}catch(a){return o(a,null),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/",Promise.reject(a)}finally{r=!1}}return Promise.reject(e)}));const d=s},6435:(e,t,a)=>{a.d(t,{A:()=>l});a(5043);var n=a(615),s=a(1932),r=a(579);function l(){const e=(0,r.jsx)(n.A,{id:"logout-tooltip",className:"custom-tooltip",children:"\u0627\u0644\u0645\u0628\u0631\u0645\u062c\u064a\u0646 : \u0645\u0635\u0637\u0641\u0649 \u0646\u062c\u0645 - \u062c\u064a\u0627\u0646 \u062d\u0633\u064a\u0646"});return(0,r.jsx)(s.A,{placement:"top",className:"custom-tooltip",overlay:e,children:(0,r.jsxs)("footer",{className:"page-footer",children:["\u062c\u0645\u064a\u0639 \u0627\u0644\u062d\u0642\u0648\u0642 \u0645\u062d\u0641\u0648\u0638\u0629 \xa9 ",(new Date).getFullYear()," \u0642\u0633\u0645 \u062a\u0642\u0646\u064a\u0629 \u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062a"]})})}},6876:()=>{},6957:(e,t,a)=>{a.d(t,{A:()=>i});var n=a(5043),s=a(3216),r=a(5475),l=a(6213),o=a(1932),d=a(615),c=a(579);function i(){const e=(0,s.Zp)(),[t,a]=(0,n.useState)(""),[i,m]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=localStorage.getItem("username");e&&a(e);const t=localStorage.getItem("UserDepartment");t&&m(t)}),[]);const h=(e,t)=>(0,c.jsx)(r.k2,{to:e,className:e=>{let{isActive:t}=e;return"text-decoration-none nav-link"+(t?" active-link":"")},end:!0,"aria-current":"page",children:t});return(0,c.jsxs)("nav",{className:"bg-custom d-flex justify-content-between flex-row-reverse p-3","aria-label":"Primary navigation",children:[(0,c.jsx)("div",{className:"fs-4 fw-bold hlogo",children:(0,c.jsxs)(r.k2,{to:"/dashboard",className:"nav-brand-link",children:["\u0646\u0638\u0627\u0645 \u0627\u0644\u0645\u0646\u062d \u0648\u0627\u0644\u0642\u0631\u0648\u0636",(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",margin:"0 10px"},children:(0,c.jsx)("img",{src:"/Images/bank.png",className:"logo-shadow-rounded",alt:"",width:"50px",height:"50px"})})]})}),(0,c.jsxs)("ul",{className:"d-flex flex-row-reverse gap-3 list-unstyled mb-0 align-items-center fw-bold",children:[(0,c.jsx)("li",{children:h("/dashboard","\u0627\u0644\u0635\u0641\u062d\u0629 \u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629")}),(0,c.jsx)("li",{children:h("/contracts"," \u0627\u0644\u0639\u0642\u0648\u062f")}),(0,c.jsx)("li",{children:h("/Loans"," \u0627\u0644\u0642\u0631\u0648\u0636")}),(0,c.jsx)("li",{children:h("/RevenueList"," \u0627\u0644\u0627\u064a\u0631\u0627\u062f\u0627\u062a")}),(0,c.jsx)("li",{children:h("/AdminPanel","\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646")})]}),(0,c.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,c.jsx)(o.A,{placement:"bottom",overlay:(0,c.jsx)(d.A,{id:"logout-tooltip",children:"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c"}),children:(0,c.jsxs)("button",{"aria-label":"\u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c",className:"btn btn-outline-danger logoutB",onClick:async()=>{try{await l.A.post("http://localhost:5109/Auth/logout",{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),localStorage.removeItem("token"),localStorage.removeItem("roles"),localStorage.removeItem("username"),e("/")}catch(t){console.error("Logout failed:",t),alert("\u0641\u0634\u0644 \u062a\u0633\u062c\u064a\u0644 \u0627\u0644\u062e\u0631\u0648\u062c\u060c \u062d\u0627\u0648\u0644 \u0645\u0631\u0629 \u0623\u062e\u0631\u0649.")}},type:"button",children:[(0,c.jsx)("span",{className:"navbar-username",children:t.toUpperCase()}),(0,c.jsx)("img",{className:"PowImg",src:"/Images/power.gif",alt:"Power GIF",style:{borderRadius:"50%"},width:"20",height:"20"})]})}),(0,c.jsx)("h6",{className:"headingDep",children:i||"\u0644\u0627 \u064a\u0648\u062c\u062f \u0642\u0633\u0645"}),(0,c.jsx)("span",{className:"navbar-username",children:(0,c.jsx)(r.k2,{to:"/ChangePassword",className:"nav-brand-link",children:"\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"})})]})]})}},7147:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var n=a(5043),s=a(5150),r=(a(6876),a(6957)),l=a(6435),o=a(1238),d=a(2450),c=a(579);function i(){const[e,t]=(0,n.useState)(""),[a,i]=(0,n.useState)(""),[m,h]=(0,n.useState)(""),[u,p]=(0,n.useState)([]),[x,v]=(0,n.useState)([]),[f,g]=(0,n.useState)([]),[b,j]=(0,n.useState)([]),[N,y]=(0,n.useState)(""),[w,A]=(0,n.useState)(!1),[k,S]=(0,n.useState)("");(0,n.useEffect)((()=>{const e=new Date;h(e.getMonth()+1),i(e.getFullYear());const a=localStorage.getItem("UserDepartment");a&&t(a),I(),D()}),[]);const I=async()=>{try{S("");const e=await s.A.get("/Department/GetAllDep");console.log("Full API Response:",e.data);let t=[];if(Array.isArray(e.data))t=e.data.map((e=>e.DepartmentName||e.departmentName||e.name||e)).filter((e=>e&&"string"===typeof e&&""!==e.trim()));else if(e.data&&e.data.Departments)t=e.data.Departments.map((e=>e.DepartmentName||e.departmentName||e.name||e)).filter((e=>e&&"string"===typeof e&&""!==e.trim()));else if(e.data&&e.data.Loans)t=e.data.Loans.map((e=>e.DepartmentName||e.departmentName||e.name||e)).filter((e=>e&&"string"===typeof e&&""!==e.trim()));else if(e.data&&"object"===typeof e.data){const a=Object.keys(e.data);if(a.length>0){const n=a.find((t=>Array.isArray(e.data[t])));n&&(t=e.data[n].map((e=>e.DepartmentName||e.departmentName||e.name||e)).filter((e=>e&&"string"===typeof e&&""!==e.trim())))}}t=[...new Set(t)],console.log("Processed departments:",t),g(t),0===t.length&&S("\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0623\u064a \u0623\u0642\u0633\u0627\u0645 \u0641\u064a \u0627\u0644\u0646\u0638\u0627\u0645")}catch(a){var e,t;console.error("Error fetching departments:",a),S(`\u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u0627\u0644\u0623\u0642\u0633\u0627\u0645: ${(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message}`),g([])}},D=async()=>{try{S("");const e=await s.A.get("/RevenuInfo/GetAllRevenues");let t=[];e.data&&Array.isArray(e.data.loans)?t=e.data.loans:e.data&&Array.isArray(e.data.Loans)?t=e.data.Loans:Array.isArray(e.data)&&(t=e.data),console.log("Processed revenue info:",t),j(t),0===t.length&&S("\u0644\u0645 \u064a\u062a\u0645 \u0627\u0644\u0639\u062b\u0648\u0631 \u0639\u0644\u0649 \u0623\u064a \u0625\u064a\u0631\u0627\u062f\u0627\u062a \u0641\u064a \u0627\u0644\u0646\u0638\u0627\u0645")}catch(a){var e,t;console.error("Error fetching revenue info:",a),S(`\u062e\u0637\u0623 \u0641\u064a \u062c\u0644\u0628 \u0645\u0639\u0644\u0648\u0645\u0627\u062a \u0627\u0644\u0625\u064a\u0631\u0627\u062f\u0627\u062a: ${(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message}`),j([])}},$=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.reduce(((e,t,a)=>{var n;const s=`${t.id||a}-${(null===(n=t.revenueInfo)||void 0===n?void 0:n.id)||t.revenueId||""}-${t.department||t.departmentName||""}-${t.revenueCost||0}-${t.recordedDate||""}`;return e.some((e=>{var t;return`${e.id||e.index}-${(null===(t=e.revenueInfo)||void 0===t?void 0:t.id)||e.revenueId||""}-${e.department||e.departmentName||""}-${e.revenueCost||0}-${e.recordedDate||""}`===s}))||e.push({...t,index:a}),e}),[]).filter((e=>{let a=e.section||e.Section||"";return a="string"===typeof a?a.trim():"",t?""!==a:""===a})).reduce(((e,t,a)=>{let n="\u063a\u064a\u0631 \u0645\u062d\u062f\u062f";try{"string"===typeof t.department&&t.department.trim()?n=t.department.trim():t.department&&"object"===typeof t.department?n=t.department.DepartmentName||t.department.departmentName||t.department.name||"\u063a\u064a\u0631 \u0645\u062d\u062f\u062f":t.departmentName&&t.departmentName.trim()?n=t.departmentName.trim():t.Department&&t.Department.trim()&&(n=t.Department.trim())}catch(N){console.error(`Error processing revenue ${a+1}:`,N,t)}return e[n]||(e[n]=[]),e[n].push(t),e}),{})},C=$(u,!1),F=$(u,!0),W=f.map((e=>{const t=C[e]||[],a=t.reduce(((e,t)=>{const a=parseFloat(t.revenueCost||0);return e+(isNaN(a)?0:a)}),0);return{name:e,revenues:t,total:a}})),P=f.map((e=>{const t=F[e]||[],a=t.reduce(((e,t)=>{const a=parseFloat(t.revenueCost||0);return e+(isNaN(a)?0:a)}),0);return{name:e,revenues:t,total:a}})),E=f.map((e=>{const t=x.find((t=>{var a;return(null===(a=t.department)||void 0===a?void 0:a.trim())===e.trim()})),a=parseFloat((null===t||void 0===t?void 0:t.carriedForwardTotal)||0);return{name:e,revenues:[],total:isNaN(a)?0:a}}));Object.keys(C).forEach((e=>{if(!f.includes(e)){const t=C[e]||[],a=t.reduce(((e,t)=>{const a=parseFloat(t.revenueCost||0);return e+(isNaN(a)?0:a)}),0);W.push({name:e,revenues:t,total:a})}}));f.map((e=>{var t,a;const n=(null===(t=W.find((t=>t.name===e)))||void 0===t?void 0:t.total)||0,s=(null===(a=P.find((t=>t.name===e)))||void 0===a?void 0:a.total)||0;return{name:e,total:n+s}}));const R=e=>["\u064a\u0646\u0627\u064a\u0631","\u0641\u0628\u0631\u0627\u064a\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064a\u0644","\u0645\u0627\u064a\u0648","\u064a\u0648\u0646\u064a\u0648","\u064a\u0648\u0644\u064a\u0648","\u0623\u063a\u0633\u0637\u0633","\u0633\u0628\u062a\u0645\u0628\u0631","\u0623\u0643\u062a\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062f\u064a\u0633\u0645\u0628\u0631"][parseInt(e)-1]||e,L=e=>{const t=parseFloat(e||0);return isNaN(t)?"0":t.toLocaleString()};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.A,{}),(0,c.jsxs)("div",{className:"container my-5",style:{direction:"rtl"},children:[(0,c.jsx)("h2",{className:"text-primary mb-4",children:"\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0625\u064a\u0631\u0627\u062f\u0627\u062a \u062d\u0633\u0628 \u0627\u0644\u0623\u0642\u0633\u0627\u0645"}),N&&(0,c.jsx)("div",{className:"alert alert-danger",children:N}),k&&(0,c.jsx)("div",{className:"alert alert-warning",children:k}),(0,c.jsxs)("div",{className:"row g-3 align-items-center mb-4",children:[(0,c.jsxs)("div",{className:"col-auto",children:[(0,c.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0634\u0647\u0631:"}),(0,c.jsxs)("select",{className:"form-select",value:m,onChange:e=>h(e.target.value),disabled:w,children:[(0,c.jsx)("option",{value:"",children:"\u0627\u062e\u062a\u0631 \u0627\u0644\u0634\u0647\u0631"}),[...Array(12)].map(((e,t)=>(0,c.jsxs)("option",{value:t+1,children:[t+1," - ",R(t+1)]},t+1)))]})]}),(0,c.jsxs)("div",{className:"col-auto",children:[(0,c.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0633\u0646\u0629:"}),(0,c.jsx)("input",{type:"number",className:"form-control",value:a,onChange:e=>i(e.target.value),placeholder:"2025",min:"2020",max:"2030",disabled:w})]}),(0,c.jsxs)("div",{className:"col-auto",children:[(0,c.jsx)("label",{className:"form-label",children:"\u0627\u0644\u0642\u0633\u0645 (\u0627\u062e\u062a\u064a\u0627\u0631\u064a):"}),(0,c.jsxs)("select",{className:"form-select",value:e,onChange:e=>t(e.target.value),disabled:w,children:[(0,c.jsx)("option",{value:"",children:"\u062c\u0645\u064a\u0639 \u0627\u0644\u0623\u0642\u0633\u0627\u0645"}),f.map((e=>(0,c.jsx)("option",{value:e,children:e},e)))]})]}),(0,c.jsx)("div",{className:"col-auto",children:(0,c.jsx)("button",{className:"btn btn-primary",onClick:()=>{(async()=>{if(a&&m){A(!0),y("");try{const t=`/BudgetRevenue/GetReportByDateAndDep?year=${a}&month=${m}&department=${encodeURIComponent(e)}`;console.log("Fetching revenues from:",t);const n=await s.A.get(t);console.log("Revenues API Response:",n.data);let r=[];if(Array.isArray(n.data))r=n.data;else if(n.data&&Array.isArray(n.data.revenues))r=n.data.revenues;else if(n.data&&Array.isArray(n.data.data))r=n.data.data;else if(n.data&&"object"===typeof n.data){const e=Object.keys(n.data).find((e=>Array.isArray(n.data[e])));e&&(r=n.data[e])}console.log("Processed revenues data:",r),p(r)}catch(l){var t,n,r;console.error("Error fetching revenues:",l),404===(null===(t=l.response)||void 0===t?void 0:t.status)?(p([]),y("\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u0641\u062a\u0631\u0629 \u0627\u0644\u0645\u062d\u062f\u062f\u0629.")):y(`\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a: ${(null===(n=l.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.message)||l.message}`)}finally{A(!1)}}else y("\u064a\u0631\u062c\u0649 \u062a\u062d\u062f\u064a\u062f \u0627\u0644\u0634\u0647\u0631 \u0648\u0627\u0644\u0633\u0646\u0629.")})(),(async()=>{const t=1===m?1:m;A(!0),y("");try{const n=`/BudgetRevenue/GetReportForward?year=${a}&month=${t}&department=${encodeURIComponent(e||"")}`;console.log("Fetching carried forward from:",n);const r=await s.A.get(n);console.log("Carried forward API response:",r.data);let l=[];Array.isArray(r.data)?l=r.data:r.data&&Array.isArray(r.data.data)?l=r.data.data:"object"===typeof r.data&&r.data.Department&&"undefined"!==typeof r.data.CarriedForwardTotal&&(l=[r.data]),console.log("Processed forward totals:",l),v(l)}catch(o){var n,r,l;console.error("Error fetching carried forward totals:",o),404===(null===(n=o.response)||void 0===n?void 0:n.status)?(v([]),y("\u0644\u0627 \u062a\u0648\u062c\u062f \u0628\u064a\u0627\u0646\u0627\u062a \u0644\u0644\u0641\u062a\u0631\u0629 \u0627\u0644\u0645\u062d\u062f\u062f\u0629.")):y(`\u0641\u0634\u0644 \u0641\u064a \u062c\u0644\u0628 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a: ${(null===(r=o.response)||void 0===r||null===(l=r.data)||void 0===l?void 0:l.message)||o.message}`)}finally{A(!1)}})()},disabled:w||!a||!m,children:w?"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644...":"\u0639\u0631\u0636 \u0627\u0644\u062a\u0642\u0631\u064a\u0631"})}),(0,c.jsxs)("div",{className:"col-auto",children:[(0,c.jsx)("button",{className:"btn btn-success",onClick:()=>{const t=W.filter((t=>!e||t.name===e));if(0!==t.length)try{const e=[];t.forEach((t=>{e.push({"\u0627\u0644\u0642\u0633\u0645":t.name,"\u0627\u0644\u0631\u0645\u0632":"","\u0627\u0633\u0645 \u0627\u0644\u0625\u064a\u0631\u0627\u062f":"","\u0627\u0644\u0641\u0635\u0644":"","\u0627\u0644\u0646\u0648\u0639":"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":"","\u0627\u0644\u0645\u0628\u0644\u063a":"","\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u062c\u064a\u0644":"","\u0645\u0644\u0627\u062d\u0638\u0627\u062a":""}),0===t.revenues.length?e.push({"\u0627\u0644\u0642\u0633\u0645":"","\u0627\u0644\u0631\u0645\u0632":"","\u0627\u0633\u0645 \u0627\u0644\u0625\u064a\u0631\u0627\u062f":"\u0644\u0627 \u062a\u0648\u062c\u062f \u0625\u064a\u0631\u0627\u062f\u0627\u062a","\u0627\u0644\u0641\u0635\u0644":"","\u0627\u0644\u0646\u0648\u0639":"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":"","\u0627\u0644\u0645\u0628\u0644\u063a":0,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u062c\u064a\u0644":"","\u0645\u0644\u0627\u062d\u0638\u0627\u062a":""}):t.revenues.forEach((t=>{var a,n,s,r,l;e.push({"\u0627\u0644\u0642\u0633\u0645":"","\u0627\u0644\u0631\u0645\u0632":(null===(a=t.revenueInfo)||void 0===a?void 0:a.symbol)||t.symbol||"","\u0627\u0633\u0645 \u0627\u0644\u0625\u064a\u0631\u0627\u062f":(null===(n=t.revenueInfo)||void 0===n?void 0:n.revenueName)||t.name||"","\u0627\u0644\u0641\u0635\u0644":(null===(s=t.revenueInfo)||void 0===s?void 0:s.chapter)||t.chapter||"","\u0627\u0644\u0646\u0648\u0639":(null===(r=t.revenueInfo)||void 0===r?void 0:r.type)||t.type||"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":(null===(l=t.revenueInfo)||void 0===l?void 0:l.typeDetails)||t.typeDetails||"","\u0627\u0644\u0645\u0628\u0644\u063a":t.revenueCost||0,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u062c\u064a\u0644":t.recordedDate?"string"===typeof t.recordedDate?t.recordedDate.slice(0,10):new Date(t.recordedDate).toLocaleDateString("en-CA"):"","\u0645\u0644\u0627\u062d\u0638\u0627\u062a":t.notes||""})})),e.push({"\u0627\u0644\u0642\u0633\u0645":"","\u0627\u0644\u0631\u0645\u0632":"","\u0627\u0633\u0645 \u0627\u0644\u0625\u064a\u0631\u0627\u062f":"\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0642\u0633\u0645","\u0627\u0644\u0641\u0635\u0644":"","\u0627\u0644\u0646\u0648\u0639":"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":"","\u0627\u0644\u0645\u0628\u0644\u063a":t.total,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u062c\u064a\u0644":"","\u0645\u0644\u0627\u062d\u0638\u0627\u062a":""}),e.push({"\u0627\u0644\u0642\u0633\u0645":"","\u0627\u0644\u0631\u0645\u0632":"","\u0627\u0633\u0645 \u0627\u0644\u0625\u064a\u0631\u0627\u062f":"","\u0627\u0644\u0641\u0635\u0644":"","\u0627\u0644\u0646\u0648\u0639":"","\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644":"","\u0627\u0644\u0645\u0628\u0644\u063a":"","\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u062a\u0633\u062c\u064a\u0644":"","\u0645\u0644\u0627\u062d\u0638\u0627\u062a":""})}));const n=o.Wp.json_to_sheet(e),s=o.Wp.book_new();o.Wp.book_append_sheet(s,n,"Revenues");const r=o.M9(s,{bookType:"xlsx",type:"array"}),l=new Blob([r],{type:"application/octet-stream"});(0,d.saveAs)(l,`revenue-report-${a}-${String(m).padStart(2,"0")}.xlsx`)}catch(n){console.error("Error exporting to Excel:",n),alert(`\u062d\u062f\u062b \u062e\u0637\u0623 \u0623\u062b\u0646\u0627\u0621 \u0627\u0644\u062a\u0635\u062f\u064a\u0631: ${n.message}`)}else alert("\u0644\u0627 \u062a\u0648\u062c\u062f \u0623\u0642\u0633\u0627\u0645 \u0644\u0644\u062a\u0635\u062f\u064a\u0631")},disabled:w||0===W.length,children:"\u062a\u0635\u062f\u064a\u0631 Excel"}),(0,c.jsx)("button",{onClick:()=>{const e=document.getElementById("print-area");if(!e)return;const t=window.open("","_blank"),a=e.innerHTML;t.document.write(`\n      <html>\n        <head>\n          <title>\u062a\u0642\u0631\u064a\u0631 \u0627\u0644\u0625\u064a\u0631\u0627\u062f\u0627\u062a</title>\n          <style>\n            body { font-family: Arial, sans-serif; direction: rtl; margin: 20px; }\n            table { border-collapse: collapse; width: 100%; margin-bottom: 20px; }\n            th, td { border: 1px solid #ddd; padding: 8px; text-align: center; font-size: 12px; }\n            th { background-color: #f2f2f2; font-weight: bold; }\n            .table-dark th { background-color: #343a40; color: white; }\n            .table-warning { background-color: #fff3cd; }\n            .table-success { background-color: #d1edff; }\n            .table-info { background-color: #d1ecf1; }\n            .badge { padding: 4px 8px; border-radius: 4px; font-size: 10px; }\n            .bg-success { background-color: #28a745; color: white; }\n            .bg-warning { background-color: #ffc107; color: black; }\n            .bg-info { background-color: #17a2b8; color: white; }\n            .bg-secondary { background-color: #6c757d; color: white; }\n            .text-dark { color: black; }\n            @media print {\n              body { margin: 0; }\n              table { page-break-inside: avoid; }\n            }\n          </style>\n        </head>\n        <body>\n          <h2 style="text-align: center; margin-bottom: 30px;">\u0648\u0632\u0627\u0631\u0629 \u0627\u0644\u0645\u0648\u0627\u0631\u062f \u0627\u0644\u0645\u0627\u0626\u064a\u0629 / \u0627\u0644\u0627\u064a\u0631\u0627\u062f\u0627\u062a \u0644\u0634\u0647\u0631 ${R(m)}</h2>\n\n          ${a}\n        </body>\n      </html>\n    `),t.document.close(),t.print()},className:"btn btn-secondary mb-3 mx-3",children:"\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062a\u0642\u0631\u064a\u0631"})]})]}),w?(0,c.jsx)("div",{className:"d-flex justify-content-center my-5",children:(0,c.jsx)("div",{className:"spinner-border",role:"status",children:(0,c.jsx)("span",{className:"visually-hidden",children:"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."})})}):a&&m?0!==f.length||k?(0,c.jsx)("div",{className:"departments-report",children:(0,c.jsxs)("div",{className:"card mt-4",children:[(0,c.jsx)("div",{className:"card-header bg-primary text-white",children:(0,c.jsx)("h5",{className:"mb-0",children:"\u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0625\u064a\u0631\u0627\u062f\u0627\u062a \u062d\u0633\u0628 \u0627\u0644\u0623\u0642\u0633\u0627\u0645"})}),(0,c.jsx)("div",{className:"card-body p-0",children:(0,c.jsx)("div",{className:"table-responsive",id:"print-area",children:(0,c.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,c.jsx)("thead",{className:"table-dark",children:(0,c.jsxs)("tr",{style:{minWidth:"100px",fontSize:"12px",margin:"0",padding:"0"},children:[(0,c.jsx)("th",{className:"text-center",children:"\u0627\u0644\u0642\u0633\u0645"}),(0,c.jsx)("th",{className:"text-center",children:"\u0627\u0644\u0641\u0635\u0644"}),(0,c.jsx)("th",{className:"text-center",children:"\u0627\u0644\u0645\u0627\u062f\u0629"}),(0,c.jsx)("th",{className:"text-center",children:"\u0627\u0644\u0646\u0648\u0639"}),(0,c.jsx)("th",{className:"text-center",children:"\u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0646\u0648\u0639"}),(0,c.jsx)("th",{className:"text-center",children:"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"}),W.map((e=>(0,c.jsx)("th",{className:"text-center",children:e.name},e.name)))]})}),(0,c.jsx)("tbody",{children:[...new Map(b.map((e=>[e.id,e]))).values()].filter((e=>e.section&&""!==e.section.trim())).map((e=>(0,c.jsxs)("tr",{style:{minWidth:"100px",fontSize:"12px",margin:"0",padding:"0"},children:[(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.section}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.chapter||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.material||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.type||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.typeDetails||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.revenueName||""}),W.map((t=>{var a;const n=t.revenues.find((t=>{var a;return(null===(a=t.revenueInfo)||void 0===a?void 0:a.id)===e.id||t.revenueId===e.id}));return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:`badge ${(null===n||void 0===n?void 0:n.revenueCost)<0?"bg-danger":"bg-success"} fs-6`,children:L(null!==(a=null===n||void 0===n?void 0:n.revenueCost)&&void 0!==a?a:0)})},t.name)}))]},e.id)))}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-info",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a \u0644\u0643\u0644 \u0627\u0644\u0623\u0642\u0633\u0627\u0645:"}),(0,c.jsx)("td",{className:"text-center fw-bold",children:(0,c.jsx)("span",{className:"badge bg-info fs-6",children:L(W.reduce(((e,t)=>e+(parseFloat(t.total)||0)),0)+E.reduce(((e,t)=>e+(parseFloat(t.total)||0)),0))})})]})}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-warning",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 :"}),W.map((e=>(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-warning text-dark fs-6",children:L(e.total)})},e.name)))]})}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-warning",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062f\u0648\u0631 :"}),f.map((e=>{var t,a;const n=E.find((t=>t.department===e||t.name===e)),s=null!==(t=null!==(a=null===n||void 0===n?void 0:n.carriedForwardTotal)&&void 0!==a?a:null===n||void 0===n?void 0:n.total)&&void 0!==t?t:0;return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-warning text-dark fs-6",children:L(s)})},e)}))]})}),(0,c.jsxs)("tfoot",{children:[(0,c.jsxs)("tr",{className:"table-success",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a :"}),f.map((e=>{var t,a;const n=((null===(t=W.find((t=>t.name===e)))||void 0===t?void 0:t.total)||0)+((null===(a=E.find((t=>t.name===e)))||void 0===a?void 0:a.total)||0);return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-success fs-6",children:L(n)})},e)}))]}),[...new Map(b.map((e=>[e.id,e]))).values()].filter((e=>e.section&&""===e.section.trim())).map((e=>(0,c.jsxs)("tr",{style:{minWidth:"100px",fontSize:"12px",margin:"0",padding:"0"},children:[(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.section}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.chapter||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.material||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.type||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.typeDetails||""}),(0,c.jsx)("td",{style:{fontWeight:"bold"},className:"text-center",children:e.revenueName||""}),W.map((t=>{const a=t.revenues.find((t=>{var a;return(null===(a=t.revenueInfo)||void 0===a?void 0:a.id)===e.id||t.revenueId===e.id}));return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:`badge ${a?"bg-success":"bg-secondary"} fs-6`,children:L((null===a||void 0===a?void 0:a.revenueCost)||0)})},t.name)}))]},e.id)))]})]})})}),(0,c.jsx)("div",{className:"card-body p-0",children:(0,c.jsx)("div",{className:"table-responsive",children:(0,c.jsxs)("table",{className:"table table-striped table-hover mb-0",children:[(0,c.jsx)("tbody",{children:[...new Map(b.map((e=>[e.id,e]))).values()].filter((e=>!e.section||""===e.section.trim())).map((e=>(0,c.jsxs)("tr",{style:{minWidth:"100px",fontSize:"12px",margin:"0",padding:"0"},children:[(0,c.jsx)("td",{className:"text-center fw-bold",children:e.section}),(0,c.jsx)("td",{className:"text-center fw-bold",children:e.chapter||""}),(0,c.jsx)("td",{className:"text-center fw-bold",children:e.material||""}),(0,c.jsx)("td",{className:"text-center fw-bold",children:e.type||""}),(0,c.jsx)("td",{className:"text-center fw-bold",children:e.typeDetails||""}),(0,c.jsx)("td",{className:"text-center fw-bold",children:e.revenueName||""}),W.map((t=>{const a=t.revenues.find((t=>{var a;return(null===(a=t.revenueInfo)||void 0===a?void 0:a.id)===e.id||t.revenueId===e.id}));return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:`badge ${a?"bg-success":"bg-secondary"} fs-6`,children:L((null===a||void 0===a?void 0:a.revenueCost)||0)})},t.name)}))]},e.id)))}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-info",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a \u0644\u0643\u0644 \u0627\u0644\u0623\u0642\u0633\u0627\u0645:"}),(0,c.jsx)("td",{className:"text-center fw-bold",children:(0,c.jsx)("span",{className:"badge bg-info fs-6",children:L(P.reduce(((e,t)=>e+(parseFloat(t.total)||0)),0)+E.reduce(((e,t)=>e+(parseFloat(t.total)||0)),0))})})]})}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-warning",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 :"}),P.map((e=>(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-warning text-dark fs-6",children:L(e.total)})},e.name)))]})}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-warning",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062f\u0648\u0631 :"}),f.map((e=>{var t,a;const n=E.find((t=>t.department===e||t.name===e)),s=null!==(t=null!==(a=null===n||void 0===n?void 0:n.carriedForwardTotal)&&void 0!==a?a:null===n||void 0===n?void 0:n.total)&&void 0!==t?t:0;return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-warning text-dark fs-6",children:L(s)})},e)}))]})}),(0,c.jsx)("tfoot",{children:(0,c.jsxs)("tr",{className:"table-success",children:[(0,c.jsx)("td",{colSpan:"6",className:"text-end fw-bold",children:"\u0627\u0644\u0645\u062c\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064a :"}),f.map((e=>{var t,a;const n=((null===(t=P.find((t=>t.name===e)))||void 0===t?void 0:t.total)||0)+((null===(a=E.find((t=>t.name===e)))||void 0===a?void 0:a.total)||0);return(0,c.jsx)("td",{className:"text-center",children:(0,c.jsx)("span",{className:"badge bg-success fs-6",children:L(n)})},e)}))]})})]})})})]})}):(0,c.jsxs)("div",{className:"alert alert-warning text-center",children:["\u0644\u0627 \u062a\u0648\u062c\u062f \u0623\u0642\u0633\u0627\u0645 \u0645\u0633\u062c\u0644\u0629 \u0641\u064a \u0627\u0644\u0646\u0638\u0627\u0645",(0,c.jsx)("br",{}),(0,c.jsx)("button",{className:"btn btn-sm btn-outline-primary mt-2",onClick:I,children:"\u0625\u0639\u0627\u062f\u0629 \u0627\u0644\u0645\u062d\u0627\u0648\u0644\u0629"})]}):(0,c.jsx)("div",{className:"alert alert-info text-center",children:"\u064a\u0631\u062c\u0649 \u062a\u062d\u062f\u064a\u062f \u0627\u0644\u0634\u0647\u0631 \u0648\u0627\u0644\u0633\u0646\u0629 \u0644\u0639\u0631\u0636 \u0627\u0644\u062a\u0642\u0631\u064a\u0631"})]}),(0,c.jsx)(l.A,{})]})}}}]);
//# sourceMappingURL=147.da561eee.chunk.js.map