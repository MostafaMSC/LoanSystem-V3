"use strict";(self.webpackChunkloan_system=self.webpackChunkloan_system||[]).push([[488],{4488:(e,s,r)=>{r.r(s),r.d(s,{default:()=>d});var a=r(5043),t=r(4858),o=r(5150),n=r(7488),l=r(3216),c=r(579);const i=e=>{let{strength:s}=e;const r=["danger","danger","warning","info","success","success"];return(0,c.jsxs)("div",{className:"password-strength mt-2",children:[(0,c.jsx)("div",{className:"progress",style:{height:"5px"},children:(0,c.jsx)("div",{className:`progress-bar bg-${r[s]}`,style:{width:s/5*100+"%"}})}),(0,c.jsx)("small",{className:`text-${r[s]}`,children:["Very Weak","Weak","Fair","Good","Strong","Very Strong"][s]})]})},d=()=>{const{register:e,handleSubmit:s,watch:r,formState:{errors:d},reset:u}=(0,t.mN)(),[h,m]=(0,a.useState)(!1),[p,w]=(0,a.useState)(null),[f,v]=(0,a.useState)(0),g=(0,l.Zp)();return(0,c.jsxs)("div",{className:"password-change-form",children:[(0,c.jsx)("h2",{children:"\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"}),(0,c.jsxs)("form",{onSubmit:s((async e=>{if(p){m(!0);try{const s=await o.A.post("/Auth/change-password",e);s.data.success?(n.oR.success(s.data.message),u(),w(null),v(0)):n.oR.error(s.data.message)}catch(c){var s,r,a,t,l;const e=(null===(s=c.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.message)||(null===(a=c.response)||void 0===a||null===(t=a.data)||void 0===t||null===(l=t.errors)||void 0===l?void 0:l.join("\n"))||"Password change failed";n.oR.error(e)}finally{m(!1)}}else n.oR.error("Please validate your current password first")})),children:[(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629"}),(0,c.jsx)("input",{type:"password",className:`form-control ${d.currentPassword||!1===p?"is-invalid":""} ${p?"is-valid":""}`,...e("currentPassword",{required:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0627\u0644\u062d\u0627\u0644\u064a\u0629 \u0645\u0637\u0644\u0648\u0628\u0629",onBlur:async()=>{const e=r("currentPassword");if(e)try{const s=await o.A.post("/Auth/validate-current-password",{password:e});w(s.data.isValid)}catch(s){n.oR.error("Failed to validate current password")}}})}),d.currentPassword&&(0,c.jsx)("div",{className:"invalid-feedback",children:d.currentPassword.message}),!1===p&&(0,c.jsx)("div",{className:"invalid-feedback",children:"Current password is incorrect"})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"\u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629"}),(0,c.jsx)("input",{type:"password",className:"form-control "+(d.newPassword?"is-invalid":""),...e("newPassword"),onChange:e=>v((e=>{let s=0;return e.length>=8&&s++,e.length>=12&&s++,/[A-Z]/.test(e)&&s++,/[a-z]/.test(e)&&s++,/[0-9]/.test(e)&&s++,/[^A-Za-z0-9]/.test(e)&&s++,Math.min(s,5)})(e.target.value))}),d.newPassword&&(0,c.jsx)("div",{className:"invalid-feedback",children:d.newPassword.message}),(0,c.jsx)(i,{strength:f})]}),(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{children:"\u062a\u0623\u0643\u064a\u062f \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631 \u0627\u0644\u062c\u062f\u064a\u062f\u0629"}),(0,c.jsx)("input",{type:"password",className:"form-control "+(d.confirmPassword?"is-invalid":""),...e("confirmPassword")}),d.confirmPassword&&(0,c.jsx)("div",{className:"invalid-feedback",children:d.confirmPassword.message})]}),(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"\u064a\u062a\u0645 \u0627\u0644\u062a\u063a\u064a\u064a\u0631...":"\u062a\u063a\u064a\u064a\u0631 \u0643\u0644\u0645\u0629 \u0627\u0644\u0633\u0631"}),(0,c.jsx)("button",{type:"button",className:"btn btn-default form-control p-1 mt-1",onClick:()=>{g("/")},children:"\u0625\u0644\u063a\u0627\u0621/ \u0627\u0644\u0639\u0648\u062f\u0629"})]})]})}},5150:(e,s,r)=>{r.d(s,{A:()=>c});var a=r(6213);const t=a.A.create({baseURL:"http://localhost:5109",withCredentials:!0});let o=!1,n=[];const l=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.forEach((r=>{e?r.reject(e):r.resolve(s)})),n=[]};t.interceptors.request.use((e=>{const s=localStorage.getItem("token");return s&&(e.headers.Authorization=`Bearer ${s}`),e})),t.interceptors.response.use((e=>e),(async e=>{const s=e.config;if(s&&!s._retry&&("Access token expired"===e.message||e.response&&401===e.response.status)){if(o)return new Promise(((e,s)=>{n.push({resolve:e,reject:s})})).then((e=>(s.headers.Authorization=`Bearer ${e}`,t(s)))).catch((e=>Promise.reject(e)));s._retry=!0,o=!0;try{const e=await a.A.post("http://localhost:5109/auth/refresh",{},{withCredentials:!0}),r=e.data.accessToken;e.data.refreshToken;return localStorage.setItem("token",r),l(null,r),s.headers.Authorization=`Bearer ${r}`,t(s)}catch(r){return l(r,null),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),window.location.href="/",Promise.reject(r)}finally{o=!1}}return Promise.reject(e)}));const c=t}}]);
//# sourceMappingURL=488.3d6d1007.chunk.js.map